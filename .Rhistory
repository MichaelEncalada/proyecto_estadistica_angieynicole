# Filtrar solo casos completos para las variables que vamos a usar
empleo_mv <- empleo_mod %>%
select(trabajo_formal_v2, interh, sexo_d, estciv_ord, dominio, lengua_cat, ultani_cat) %>%
filter(!is.na(trabajo_formal_v2) &
!is.na(interh) &
!is.na(sexo_d) &
!is.na(estciv_ord) &
!is.na(dominio) &
!is.na(lengua_cat) &
!is.na(ultani_cat))
# Regresión logística
modelo_logit <- glm(trabajo_formal_v2 ~ interh + sexo_d + estciv_ord + dominio + lengua_cat + ultani_cat,
data = empleo_mv,
family = binomial(link = "logit"))
# Resumen del modelo
summary(modelo_logit)
library(dplyr)
library(broom)
# Filtrar solo casos completos para las variables que vamos a usar
empleo_mv <- empleo_mod %>%
select(trabajo_formal_v2, interh, sexo_d, estciv_ord, dominio, lengua_cat, ultani_cat) %>%
filter(!is.na(trabajo_formal_v2) &
!is.na(interh) &
!is.na(sexo_d) &
!is.na(estciv_ord) &
!is.na(dominio) &
!is.na(lengua_cat) &
!is.na(ultani_cat))
# Regresión logística
modelo_logit <- glm(trabajo_formal_v2 ~ interh + sexo_d + edad + estciv_ord + dominio + lengua_cat + ultani_cat,
data = empleo_mv,
family = binomial(link = "logit"))
library(dplyr)
library(broom)
# Filtrar solo casos completos para las variables que vamos a usar
empleo_mv <- empleo_mod %>%
select(trabajo_formal_v2, interh, sexo_d, estciv_ord, dominio, lengua_cat, ultani_cat) %>%
filter(!is.na(trabajo_formal_v2) &
!is.na(interh) &
!is.na(sexo_d) &
!is.na(estciv_ord) &
!is.na(dominio) &
!is.na(lengua_cat) &
!is.na(ultani_cat))
# Regresión logística
modelo_logit <- glm(trabajo_formal_v2 ~ interh + sexo_d + estciv_ord + dominio + lengua_cat + ultani_cat,
data = empleo_mv,
family = binomial(link = "logit"))
# Resumen del modelo
summary(modelo_logit)
library(dplyr)
library(broom)
# Filtrar solo casos completos para las variables que vamos a usar
empleo_mv <- empleo_mod %>%
select(trabajo_formal_v2, interh, sexo_d, edad, estciv_ord, dominio, lengua_cat, ultani_cat) %>%
filter(!is.na(trabajo_formal_v2) &
!is.na(interh) &
!is.na(sexo_d) &
!is.na(estciv_ord) &
!is.na(dominio) &
!is.na(lengua_cat) &
!is.na(ultani_cat))
# Regresión logística
modelo_logit <- glm(trabajo_formal_v2 ~ interh + sexo_d + edad + estciv_ord + dominio + lengua_cat + ultani_cat,
data = empleo_mv,
family = binomial(link = "logit"))
# Resumen del modelo
summary(modelo_logit)
# Odds ratios y intervalos de confianza
exp(cbind(OddsRatio = coef(modelo_logit), confint(modelo_logit)))
# Tabla resumida con broom (opcional)
library(broom)
tidy(modelo_logit, exponentiate = TRUE, conf.int = TRUE)
# Odds ratios y intervalos de confianza
exp(cbind(OddsRatio = coef(modelo_logit), confint(modelo_logit)))
library(dplyr)
library(broom)
library(ggplot2)
# Extraer tabla con coeficientes, OR y CI
modelo_tidy <- tidy(modelo_logit, exponentiate = TRUE, conf.int = TRUE)
# Filtrar solo significativos (p < 0.05)
modelo_sig <- modelo_tidy %>%
filter(p.value < 0.05 & term != "(Intercept)")
# Ver resultados
modelo_sig
# Gráfico de odds ratios con intervalos de confianza
ggplot(modelo_sig, aes(x = reorder(term, estimate), y = estimate)) +
geom_point(size = 3, color = "#4D7EA8") +
geom_errorbar(aes(ymin = conf.low, ymax = conf.high), width = 0.2, color = "#4D7EA8") +
coord_flip() +
labs(
title = "Odds Ratios de las variables significativas",
x = "Variable",
y = "Odds Ratio (OR)",
) +
geom_hline(yintercept = 1, linetype = "dashed", color = "red") +
theme_minimal(base_size = 14)
# Gráfico de odds ratios con intervalos de confianza
ggplot(modelo_sig, aes(x = reorder(term, estimate), y = estimate)) +
geom_point(size = 3, color = "#4D7EA8") +
geom_errorbar(aes(ymin = conf.low, ymax = conf.high), width = 0.2, color = "#4D7EA8") +
coord_flip() +
labs(
title = "Odds Ratios",
x = "Variable",
y = "Odds Ratio (OR)",
) +
geom_hline(yintercept = 1, linetype = "dashed", color = "red") +
theme_minimal(base_size = 14)
# Gráfico de odds ratios con intervalos de confianza
ggplot(modelo_sig, aes(x = reorder(term, estimate), y = estimate)) +
geom_point(size = 3, color = "#4D7EA8") +
geom_errorbar(aes(ymin = conf.low, ymax = conf.high), width = 0.2, color = "#4D7EA8") +
coord_flip() +
labs(
title = "Variables significativos",
x = "Variable",
y = "Odds Ratio (OR)",
) +
geom_hline(yintercept = 1, linetype = "dashed", color = "red") +
theme_minimal(base_size = 14)
install.packages("FactoMineR")
install.packages("FactoMineR")
install.packages("factoextra")
install.packages("factoextra")
# Instalar si no lo tienes
# install.packages("FactoMineR")
# install.packages("factoextra")
library(FactoMineR)
install.packages("factoextra")
install.packages("factoextra")
# Instalar si no lo tienes
# install.packages("FactoMineR")
# install.packages("factoextra")
library(FactoMineR)
install.packages("htmltools")
install.packages("htmltools")
packageVersion("htmltools")
# Instalar si no lo tienes
# install.packages("FactoMineR")
# install.packages("factoextra")
library(FactoMineR)
# Instalar si no lo tienes
# install.packages("FactoMineR")
# install.packages("factoextra")
library(FactoMineR)
install.packages("htmltools")
install.packages("htmltools")
packageVersion("htmltools")
install.packages("htmltools")
install.packages("htmltools")
packageVersion("htmltools")
# Instalar si no lo tienes
# install.packages("FactoMineR")
# install.packages("factoextra")
library(FactoMineR)
install.packages("htmltools", dependencies = TRUE)
install.packages("htmltools", dependencies = TRUE)
# Instalar si no lo tienes
# install.packages("FactoMineR")
# install.packages("factoextra")
library(FactoMineR)
detach("package:htmltools", unload = TRUE)
packageVersion("htmltools")
# Instalar si no lo tienes
# install.packages("FactoMineR")
# install.packages("factoextra")
library(FactoMineR)
# Instalar si no lo tienes
# install.packages("FactoMineR")
# install.packages("factoextra")
library(FactoMineR)
remotes::install_github("rstudio/htmltools")
# Instalar si no lo tienes
# install.packages("FactoMineR")
# install.packages("factoextra")
library(FactoMineR)
packageVersion("htmltools")
install.packages("htmltools", dependencies = TRUE)
install.packages("htmltools", dependencies = TRUE)
packageVersion("htmltools")
install.packages("ade4")
library(ade4)
# Seleccionar solo variables categóricas
vars_cat <- empleo_mv %>% select(where(is.factor))
library(dplyr)
library(ade4)
# Seleccionar solo variables categóricas relevantes para el MCA
vars_mca <- empleo_mod %>%
select(sexo_d, estciv_ord, dominio, lengua_cat, ultani_cat)
# Asegurar que todas estén como factor
vars_mca <- vars_mca %>% mutate(across(everything(), as.factor))
# Ejecutar MCA (Análisis de Correspondencias Múltiples)
mca_res <- dudi.acm(vars_mca, scannf = FALSE, nf = 5)
# Resumen del MCA
mca_res
# Gráfico de individuos
plot(mca_res$li, main = "MCA - Individuos")
# Gráfico de categorías
plot(mca_res$co, main = "MCA - Categorías")
fviz_mca_var(mca_res,
repel = TRUE,
col.var = "black",
alpha.var = 0.8,
ggtheme = theme_minimal(),
title = "MCA: Posición de las categorías")
s.label(mca_res$co,
clabel = 1,
sub = "MCA - Categorías",
csub = 2)
s.label(mca_res$li,
cpoint = 0.5,
clabel = 0,
sub = "MCA - Individuos",
csub = 2)
scatter(mca_res, clabel = 0.7, posieig = "none", sub = "Biplot MCA (ade4)")
coords_ind <- as.data.frame(mca_res$li)
coords_cat <- as.data.frame(mca_res$co)
coords_cat$variable <- rownames(coords_cat)
library(ggplot2)
ggplot(coords_cat, aes(Axis1, Axis2, label = variable)) +
geom_point(color = "black", size = 3) +
geom_text(vjust = -0.5, size = 3) +
theme_minimal() +
labs(title = "MCA - Categorías",
x = "Dimensión 1",
y = "Dimensión 2")
s.label(mca_res$co, clabel = 1, sub = "MCA - Categorías")
s.label(mca_res$li,
cpoint = 0.5,
clabel = 0,
sub = "MCA - Individuos",
csub = 2)
# 1. Tomar coordenadas de individuos del MCA
coords <- mca_res$li[, 1:5]   # usa 5 dimensiones, o las que decidas
# 2. Escalar (opcional pero recomendable)
coords_scaled <- scale(coords)
# 3. Clustering jerárquico
dist_mca <- dist(coords_scaled)
hc <- hclust(dist_mca, method = "ward.D2")
# 4. Graficar dendrograma
plot(hc, main = "Dendrograma - MCA + Ward")
# 5. Elegir número de clusters (ej. 3)
clusters <- cutree(hc, k = 3)
# 6. Añadir cluster al dataframe original
empleo_mv$cluster <- factor(clusters)
# 5. Elegir número de clusters (ej. 3)
clusters <- cutree(hc, k = 2)
# 6. Añadir cluster al dataframe original
empleo_mv$cluster <- factor(clusters)
vars_mca <- empleo_mv %>%
select(sexo_d, estciv_ord, dominio, lengua_cat, ultani_cat) %>%
drop_na()
library(dplyr)
vars_mca <- empleo_mv %>%
select(sexo_d, estciv_ord, dominio, lengua_cat, ultani_cat) %>%
drop_na()
library(tidyr)
vars_mca <- empleo_mv %>%
select(sexo_d, estciv_ord, dominio, lengua_cat, ultani_cat) %>%
drop_na()
empleo_mv_clean <- empleo_mv %>%
drop_na(sexo_d, estciv_ord, dominio, lengua_cat, ultani_cat)
mca_res <- dudi.acm(vars_mca, scannf = FALSE, nf = 5)
# Seleccionar variables del MCA
vars_mca <- ocupados_mca %>%
select(trabajo_formal_final, trabajo_informal_sino, lengua_madre, regiones) %>%
mutate(across(everything(), as.factor))
# Seleccionar variables del MCA
vars_mca <- empleo_mv %>%
select(trabajo_formal_final, trabajo_informal_sino, lengua_madre, regiones) %>%
mutate(across(everything(), as.factor))
# Seleccionar variables del MCA
vars_mca <- empleo_mv %>%
select(sexo_d, estciv_ord, dominio, lengua_cat, ultani_cat) %>%
mutate(across(everything(), as.factor))
empleo_mv_clean <- empleo_mv %>%
drop_na(sexo_d, estciv_ord, dominio, lengua_cat, ultani_cat)
mca_res <- dudi.acm(vars_mca, scannf = FALSE, nf = 5)
coords <- mca_res$li[, 1:5]
dist_mca <- dist(scale(coords))
hc <- hclust(dist_mca, method = "ward.D2")
clusters <- cutree(hc, k = 3)
empleo_mv_clean$cluster <- factor(clusters)
library(ade4)
mca_res <- dudi.acm(vars_mca, scannf = FALSE, nf = 5)
library(ade4)
mca_res <- dudi.acm(vars_mca, scannf = FALSE, nf = 5)
mca_res
table(empleo_mv_clean$cluster)
library(ggplot2)
df_plot <- data.frame(coords, cluster = factor(clusters))
ggplot(df_plot, aes(Axis1, Axis2, color = cluster)) +
geom_point(alpha = 0.6) +
theme_minimal()
mca_res
library(ggplot2)
library(dplyr)
# Filtrar solo ocupados
ocupados <- data_final %>%
filter(trabsp == "Sí")
# Tabla con porcentajes
df_plot <- ocupados %>%
count(trabajo_formal_final) %>%
mutate(pct = n / sum(n) * 100)
# Gráfico
p <- ggplot(df_plot, aes(x = trabajo_formal_final, y = pct, fill = trabajo_formal_final)) +
geom_col(width = 0.7, show.legend = FALSE) +
geom_text(aes(label = paste0(round(pct, 1), "%")),
vjust = -0.5, size = 5) +
scale_y_continuous(
labels = scales::percent_format(scale = 1),
limits = c(0, 60)  # Ajuste para mostrar hasta más de 50%
) +
labs(
title = "Condición de formalidad laboral entre jóvenes ocupados",
x = "Condición laboral",
y = "Porcentaje"
) +
theme_minimal(base_size = 14)
# Exportar la imagen
ggsave(
filename = "grafico_formalidad_ocupados.png",
plot = p,
path = "C:/Users/Michael Encalada/Documents/GitHub/Trabajos/proyecto_estadistica_angieynicole/Imagenes",
width = 10,
height = 7,
dpi = 300
)
library(ggplot2)
library(dplyr)
# Calcular porcentajes solo entre ocupados
df_plot <- empleo %>%
count(interh) %>%
mutate(porc = round(100 * n / sum(n), 1))
# Gráfico actualizado
p <- ggplot(df_plot, aes(x = interh, y = porc)) +
geom_col(fill = "#4D7EA8") +
geom_text(aes(label = paste0(porc, "%")),
vjust = -0.5, size = 5) +
labs(
title = "Acceso a Internet en el hogar (jóvenes con empleo)",
x = "Acceso",
y = "Porcentaje (%)"
) +
ylim(0, max(df_plot$porc) + 10) +
theme_minimal(base_size = 14)
# Exportar imagen
ggsave(
filename = "grafico_internet_ocupados.png",
plot = p,
path = "C:/Users/Michael Encalada/Documents/GitHub/Trabajos/proyecto_estadistica_angieynicole/Imagenes",
width = 10,
height = 7,
dpi = 300
)
# Gráfico bivariado: barras apiladas
df_biv <- empleo_biv %>%
mutate(
interh = ifelse(is.na(interh), "Sin información", interh),
trabajo_formal_v2 = ifelse(is.na(trabajo_formal_v2), "Sin información", trabajo_formal_v2)
) %>%
group_by(interh, trabajo_formal_v2) %>%
summarise(n = n(), .groups = "drop") %>%
group_by(interh) %>%
mutate(porc = round(100 * n / sum(n), 1))
# Crear gráfico
p_biv <- ggplot(df_biv, aes(x = interh, y = porc, fill = trabajo_formal_v2)) +
geom_col() +
geom_text(aes(label = paste0(porc, "%")),
position = position_stack(vjust = 0.5), size = 4) +
labs(
title = "Empleo formal vs. acceso a internet en el hogar",
x = "Acceso a internet en el hogar",
y = "Porcentaje (%)",
fill = "Tipo de empleo"
) +
theme_minimal(base_size = 14)
# Exportar imagen
ggsave(
filename = "bivariado_internet_formalidad.png",
plot = p_biv,
path = "C:/Users/Michael Encalada/Documents/GitHub/Trabajos/proyecto_estadistica_angieynicole/Imagenes",
width = 10,
height = 7,
dpi = 300
)
# Gráfico bivariado: barras apiladas
df_biv <- empleo_biv %>%
group_by(interh, trabajo_formal_v2) %>%
summarise(n = n(), .groups = "drop") %>%
mutate(porc = round(100 * n / sum(n), 1))
# Crear gráfico
p_biv <- ggplot(df_biv, aes(x = interh, y = porc, fill = trabajo_formal_v2)) +
geom_col() +
geom_text(aes(label = paste0(porc, "%")),
position = position_stack(vjust = 0.5), size = 4) +
labs(
title = "Empleo formal vs. acceso a internet en el hogar",
x = "Acceso a internet en el hogar",
y = "Porcentaje (%)",
fill = "Tipo de empleo"
) +
theme_minimal(base_size = 14)
p_biv
# Exportar imagen
ggsave(
filename = "bivariado_internet_formalidad.png",
plot = p_biv,
path = "C:/Users/Michael Encalada/Documents/GitHub/Trabajos/proyecto_estadistica_angieynicole/Imagenes",
width = 10,
height = 7,
dpi = 300
)
# Gráfico de odds ratios con intervalos de confianza
# Crear gráfico de OR
p_or <- ggplot(modelo_sig, aes(x = reorder(term, estimate), y = estimate)) +
geom_point(size = 3, color = "#4D7EA8") +
geom_errorbar(aes(ymin = conf.low, ymax = conf.high),
width = 0.2, color = "#4D7EA8") +
coord_flip() +
labs(
title = "Regresión logístico",
x = "Variable",
y = "Odds Ratio (OR)"
) +
geom_hline(yintercept = 1, linetype = "dashed", color = "red") +
theme_minimal(base_size = 14)
# Exportar imagen
ggsave(
filename = "odds_ratios_modelo.png",
plot = p_or,
path = "C:/Users/Michael Encalada/Documents/GitHub/Trabajos/proyecto_estadistica_angieynicole/Imagenes",
width = 10,
height = 7,
dpi = 300
)
# Guardar gráfico MCA - Categorías como imagen
jpeg("mca_categorias.jpg", width = 1600, height = 1200, quality = 100)
s.label(mca_res$co, clabel = 1, sub = "MCA - Categorías")
dev.off()
# Guardar gráfico MCA - Categorías como imagen
jpeg("mca_categorias.jpg", width = 1600, height = 1200, quality = 100)
s.label(mca_res$co, clabel = 1, sub = "MCA - Categorías")
library(ggplotify)
# Convertir s.label() en objeto ggplot
p_mca <- s.label(mca_res$co, clabel = 1, sub = "MCA - Categorías"))
install.packages("ggplotify")
library(ggplotify)
# Convertir s.label() en objeto ggplot
p_mca <- as.ggplot(function() s.label(mca_res$co, clabel = 1, sub = "MCA - Categorías"))
# Exportar imagen
ggsave(
filename = "mca_categorias.png",
plot = p_mca,
path = "C:/Users/Michael Encalada/Documents/GitHub/Trabajos/proyecto_estadistica_angieynicole/Imagenes",
width = 10,
height = 7,
dpi = 300
)
library(ggplot2)
p_clusters <- ggplot(df_plot, aes(Axis1, Axis2, color = cluster)) +
geom_point(alpha = 0.6) +
theme_minimal()
# Exportar imagen
ggsave(
filename = "mca_clusters.png",
plot = p_clusters,
path = "C:/Users/Michael Encalada/Documents/GitHub/Trabajos/proyecto_estadistica_angieynicole/Imagenes",
width = 10,
height = 7,
dpi = 300
)
names(df_plot)
p_clusters <- ggplot(df_plot, aes(Axis1, Axis2, color = cluster)) +
geom_point(alpha = 0.6) +
theme_minimal()
library(ggplot2)
df_plot <- data.frame(coords, cluster = factor(clusters))
p_clusters <- ggplot(df_plot, aes(Axis1, Axis2, color = cluster)) +
geom_point(alpha = 0.6) +
theme_minimal()
# Exportar imagen
ggsave(
filename = "mca_clusters.png",
plot = p_clusters,
path = "C:/Users/Michael Encalada/Documents/GitHub/Trabajos/proyecto_estadistica_angieynicole/Imagenes",
width = 10,
height = 7,
dpi = 300
)
setwd("C:/Users/Michael Encalada/Documents/GitHub/Trabajos/proyecto_estadistica_angieynicole")
getwd()
library(flexdashboard)
library(readr)
library(dplyr)
library(knitr)
library(ggplot2)
# Ruta donde guardaste tus imágenes
img_path <- "C:/Users/Michael Encalada/Documents/GitHub/Trabajos/proyecto_estadistica_angieynicole/Imagenes"
files <- c("formal_ocupados.png","internet_ocupados.png","bivariado_internet_formal.png",
"odds_ratios_modelo.png","mca_categorias.png","mca_clusters.png")
file.exists(file.path(img_path, files))
files <- c(
"grafico_formalidad_ocupados.png",
"grafico_internet_ocupados.png",
"bivariado_internet_formalidad.png",
"odds_ratios_modelo.png",
"mca_categorias.png",
"mca_clusters.png"
)
file.exists(file.path(img_path, files))
